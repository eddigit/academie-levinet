"""Import members"""
import asyncio
from motor.motor_asyncio import AsyncIOMotorClient
from dotenv import load_dotenv
import os

load_dotenv()

MONGO_URL = os.environ.get('MONGO_URL')
DB_NAME = os.environ.get('DB_NAME', 'academie_levinet_db')

async def main():
    print("[*] Connexion a MongoDB Atlas...")
    client = AsyncIOMotorClient(MONGO_URL)
    db = client[DB_NAME]
    
    members_data = [
  {
    "id": "da19244d-a0d6-4275-b430-3af32c489525",
    "first_name": "Pierre",
    "last_name": "Martin",
    "email": "member_184511@test.com",
    "phone": "+33987654321",
    "date_of_birth": "1990-01-01",
    "country": "France",
    "city": "Lyon",
    "technical_director_id": "2a2e2501-8ca6-4e6b-996b-99f9120225c8",
    "photo": None,
    "belt_grade": "Ceinture Blanche",
    "membership_status": "Actif",
    "membership_type": "Standard",
    "membership_start_date": "2025-01-01",
    "membership_end_date": "2025-12-31",
    "sessions_attended": 0,
    "created_at": "2025-12-14T18:45:11.525660+00:00"
  },
  {
    "id": "3b15df30-654f-4ad5-8a73-9c4c8f5f8109",
    "first_name": "Jean",
    "last_name": "Dupont",
    "email": "jean.dupont@academie-levinet.com",
    "phone": "+33612345678",
    "date_of_birth": "1990-01-15",
    "country": "France",
    "city": "Paris",
    "technical_director_id": "test-td-1",
    "photo": None,
    "belt_grade": "Ceinture Orange",
    "membership_status": "Actif",
    "membership_type": "Premium",
    "membership_start_date": "2025-01-01",
    "membership_end_date": "2025-12-31",
    "sessions_attended": 0,
    "created_at": "2025-12-15T13:35:58.034141+00:00",
    "user_id": "3b15df30-654f-4ad5-8a73-9c4c8f5f8109"
  },
  {
    "id": "73fe56d4-d68f-41d9-8b8a-e2996d5d0407",
    "first_name": "Marie",
    "last_name": "Instructeur",
    "email": "marie.instructeur@academie.com",
    "phone": "+33698765432",
    "date_of_birth": "1985-05-20",
    "country": "France",
    "city": "Lyon",
    "belt_grade": "Ceinture Noire",
    "membership_type": "VIP",
    "membership_start_date": "2020-01-01",
    "membership_end_date": "2026-12-31",
    "membership_status": "Actif",
    "sessions_attended": 250,
    "technical_director_id": "td-001"
  },
  {
    "id": "33ab8ca1-5f3d-4aed-bf67-ab55e89def86",
    "first_name": "Pierre",
    "last_name": "Martin",
    "email": "member_174237@test.com",
    "phone": "+33987654321",
    "date_of_birth": "1990-01-01",
    "country": "France",
    "city": "Lyon",
    "technical_director_id": "22436ac7-a2a4-4325-87ce-276523bac260",
    "photo": None,
    "belt_grade": "Ceinture Blanche",
    "membership_status": "Actif",
    "membership_type": "Standard",
    "membership_start_date": "2025-01-01",
    "membership_end_date": "2025-12-31",
    "sessions_attended": 0,
    "created_at": "2025-12-18T17:42:37.674647+00:00"
  },
  {
    "id": "c432c7d6-e7aa-4927-86c2-7e9587b9e44f",
    "first_name": "Pierre",
    "last_name": "Martin",
    "email": "member_071946@test.com",
    "phone": "+33987654321",
    "date_of_birth": "1990-01-01",
    "country": "France",
    "city": "Lyon",
    "technical_director_id": "28b0a3ac-f368-4107-905a-77cd35657f1b",
    "photo": None,
    "belt_grade": "Ceinture Blanche",
    "membership_status": "Actif",
    "membership_type": "Standard",
    "membership_start_date": "2025-01-01",
    "membership_end_date": "2025-12-31",
    "sessions_attended": 0,
    "created_at": "2025-12-19T07:19:46.160211+00:00"
  },
  {
    "id": "ebb5a6eb-a8ce-429e-b868-2185b17192ce",
    "first_name": "Pierre",
    "last_name": "Martin",
    "email": "member_072014@test.com",
    "phone": "+33987654321",
    "date_of_birth": "1990-01-01",
    "country": "France",
    "city": "Lyon",
    "technical_director_id": "c1086b37-cbe3-410d-b8ab-7830c2e32957",
    "photo": None,
    "belt_grade": "Ceinture Blanche",
    "membership_status": "Actif",
    "membership_type": "Standard",
    "membership_start_date": "2025-01-01",
    "membership_end_date": "2025-12-31",
    "sessions_attended": 0,
    "created_at": "2025-12-19T07:20:14.911855+00:00"
  },
  {
    "id": "e06c3b19-1c4a-43c7-9f6b-13c7c35f376a",
    "first_name": "JACQUES",
    "last_name": "LEVINET",
    "email": "ajl.wkmo.ipc@gmail.com",
    "phone": "0698070851",
    "date_of_birth": "1951-08-08",
    "country": "France",
    "city": "Saint-Jean-de-Vedas",
    "technical_director_id": "",
    "photo": None,
    "belt_grade": "Ceinture Noire",
    "membership_status": "Actif",
    "membership_type": "VIP",
    "membership_start_date": "2025-12-19",
    "membership_end_date": "2029-12-19",
    "sessions_attended": 0,
    "created_at": "2025-12-19T07:32:36.839865+00:00"
  },
  {
    "id": "d3abda59-857b-4c0b-985d-4c59a1c15387",
    "first_name": "Pierre",
    "last_name": "Martin",
    "email": "member_145757@test.com",
    "phone": "+33987654321",
    "date_of_birth": "1990-01-01",
    "country": "France",
    "city": "Lyon",
    "technical_director_id": "3da4c2e0-cee3-47ea-b9ae-b8b7bf61147d",
    "photo": None,
    "belt_grade": "Ceinture Blanche",
    "membership_status": "Actif",
    "membership_type": "Standard",
    "membership_start_date": "2025-01-01",
    "membership_end_date": "2025-12-31",
    "sessions_attended": 0,
    "created_at": "2025-12-19T14:57:57.892630+00:00"
  },
  {
    "id": "bcd846fa-0acd-4433-85e3-cf44d40ef13b",
    "first_name": "Pierre",
    "last_name": "Martin",
    "email": "member_145824@test.com",
    "phone": "+33987654321",
    "date_of_birth": "1990-01-01",
    "country": "France",
    "city": "Lyon",
    "technical_director_id": "30b20457-95c3-44a7-b538-c0aca5674b19",
    "photo": None,
    "belt_grade": "Ceinture Blanche",
    "membership_status": "Actif",
    "membership_type": "Standard",
    "membership_start_date": "2025-01-01",
    "membership_end_date": "2025-12-31",
    "sessions_attended": 0,
    "created_at": "2025-12-19T14:58:24.959625+00:00"
  },
  {
    "id": "6ee51f1f-712e-42bc-8d97-a62772aee193",
    "first_name": "Pierre",
    "last_name": "Martin",
    "email": "member_145849@test.com",
    "phone": "+33987654321",
    "date_of_birth": "1990-01-01",
    "country": "France",
    "city": "Lyon",
    "technical_director_id": "240973d4-9aae-47ea-94a7-1ef209d2974b",
    "photo": None,
    "belt_grade": "Ceinture Blanche",
    "membership_status": "Actif",
    "membership_type": "Standard",
    "membership_start_date": "2025-01-01",
    "membership_end_date": "2025-12-31",
    "sessions_attended": 0,
    "created_at": "2025-12-19T14:58:49.848013+00:00"
  },
  {
    "id": "b09632b9-202b-4e8b-825a-8d598e374bee",
    "first_name": "Pierre",
    "last_name": "Martin",
    "email": "member_220649@test.com",
    "phone": "+33987654321",
    "date_of_birth": "1990-01-01",
    "country": "France",
    "city": "Lyon",
    "technical_director_id": "f8a8a90c-c404-46f6-930a-0070db658614",
    "photo": None,
    "belt_grade": "Ceinture Blanche",
    "membership_status": "Actif",
    "membership_type": "Standard",
    "membership_start_date": "2025-01-01",
    "membership_end_date": "2025-12-31",
    "sessions_attended": 0,
    "created_at": "2025-12-19T22:06:49.458901+00:00"
  },
  {
    "id": "03c12ba6-8f97-4841-8976-03a1ee9ae40e",
    "first_name": "Pierre",
    "last_name": "Martin",
    "email": "member_220734@test.com",
    "phone": "+33987654321",
    "date_of_birth": "1990-01-01",
    "country": "France",
    "city": "Lyon",
    "technical_director_id": "85daa679-d01a-42f5-8c4d-5ba3e4d59ee3",
    "photo": None,
    "belt_grade": "Ceinture Blanche",
    "membership_status": "Actif",
    "membership_type": "Standard",
    "membership_start_date": "2025-01-01",
    "membership_end_date": "2025-12-31",
    "sessions_attended": 0,
    "created_at": "2025-12-19T22:07:34.374663+00:00"
  },
  {
    "id": "988a55df-2f59-4348-96cc-f65e8590c166",
    "first_name": "Pierre",
    "last_name": "Martin",
    "email": "member_221237@test.com",
    "phone": "+33987654321",
    "date_of_birth": "1990-01-01",
    "country": "France",
    "city": "Lyon",
    "technical_director_id": "a8cbca99-9d30-4f6f-bad3-68cc79b40cbf",
    "photo": None,
    "belt_grade": "Ceinture Blanche",
    "membership_status": "Actif",
    "membership_type": "Standard",
    "membership_start_date": "2025-01-01",
    "membership_end_date": "2025-12-31",
    "sessions_attended": 0,
    "created_at": "2025-12-19T22:12:37.841937+00:00"
  },
  {
    "id": "2c8ce1a0-eb69-4f73-b38c-3c50d07aac0e",
    "first_name": "Pierre",
    "last_name": "Martin",
    "email": "member_222233@test.com",
    "phone": "+33987654321",
    "date_of_birth": "1990-01-01",
    "country": "France",
    "city": "Lyon",
    "technical_director_id": "b7bdaf97-6357-4032-99f2-75eacc07d379",
    "photo": None,
    "belt_grade": "Ceinture Blanche",
    "membership_status": "Actif",
    "membership_type": "Standard",
    "membership_start_date": "2025-01-01",
    "membership_end_date": "2025-12-31",
    "sessions_attended": 0,
    "created_at": "2025-12-19T22:22:34.018597+00:00"
  },
  {
    "id": "b75ef65e-f105-4638-9f9a-43462881e5e8",
    "first_name": "Pierre",
    "last_name": "Martin",
    "email": "member_184947@test.com",
    "phone": "+33987654321",
    "date_of_birth": "1990-01-01",
    "country": "France",
    "city": "Lyon",
    "technical_director_id": "642350f6-b98d-4ef7-985d-c2eadb0a591b",
    "photo": None,
    "belt_grade": "Ceinture Blanche",
    "membership_status": "Actif",
    "membership_type": "Standard",
    "membership_start_date": "2025-01-01",
    "membership_end_date": "2025-12-31",
    "sessions_attended": 0,
    "created_at": "2025-12-22T18:49:47.683414+00:00"
  }
]
    
    await db.members.delete_many({})
    result = await db.members.insert_many(members_data)
    print(f"[OK] members: {len(result.inserted_ids)} documents importes")
    
    client.close()

if __name__ == "__main__":
    asyncio.run(main())

